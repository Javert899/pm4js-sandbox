<html>
	<head>
		<link rel="stylesheet" href="ocel.css">
		<script src="scripts/generic/jquery.min.js"></script>
		<script src="scripts/generic/viz.js"></script>
		<script src="scripts/generic/download-utility.js"></script>
		<script src="scripts/generic/plotly-2.1.0.min.js"></script>
		<script src="scripts/generic/sweetalert2.all.min.js"></script>
		<script src="scripts/generic/bootstrap.min.js"></script>
		<script src="scripts/generic/navigation.min.js"></script>
		<script src="scripts/generic/fontawesome-all.min.js"></script>
		<script src="scripts/generic/sorttable.js"></script>
		<script src="scripts/generic/mxClient.min.js"></script>
		<script src="scripts/generic/sql.js"></script>
		<script src="scripts/generic/isolation-forest.js"></script>
		<script src="scripts/pm4js_latest.js"></script>
		<script src="scripts/ocel/eventsView.js"></script>
		<script src="scripts/ocel/objectsView.js"></script>
		<script src="scripts/ocel/edgesView.js"></script>
		<script src="scripts/ocel/ocdfg_execution_graph.js"></script>
		<script src="scripts/ocel/ocel_conf_num_objs.js"></script>
		<script src="scripts/ocel/ocel_conf_lifecycle_objects.js"></script>
		<script src="scripts/ocel/ocel_conf_duration_objects.js"></script>
		<script src="scripts/ocel/ocdfg-model.js"></script>
		<script src="scripts/ocel/ocdfg-visualization.js"></script>
		<script src="scripts/ocel/eventsList.js"></script>
		<script src="scripts/ocel/objectsList.js"></script>
		<script src="scripts/ocel/plotly-graphs.js"></script>
		<script src="scripts/ocel/celonis_connection.js"></script>
		<script src="scripts/ocel/celonis_download.js"></script>
		<script src="scripts/ocel/celonis_upload.js"></script>
		<script src="scripts/ocel/ml-generic.js"></script>
		<script src="scripts/ocel/ml-sql.js"></script>
		<script src="scripts/ocel/ml-isolationForest.js"></script>
		<script src="scripts/ocel/ml-pca.js"></script>
		<script src="scripts/ocel/advanced_filtering.js"></script>
		<script src="scripts/generic/jszip.min.js"></script>
		<script src="scripts/generic/jszip-utils.min.js"></script>
		<!--<script src="scripts/generic/ml.min.js"></script>-->
		<script src="scripts/generic/decision-tree-min.js"></script>
		<script src="scripts/ocel/ml-dt.js"></script>
		<script src="scripts/generic/druid.min.js"></script>
		<script src="scripts/generic/statistics.min.js"></script>
		<script src="scripts/ocel/ml-stats.js"></script>
		<link rel="stylesheet" href="static/bootstrap.min.css"></link>
		<link rel="stylesheet" href="static/bootstrap-grid.min.css"></link>
		<link rel="stylesheet" href="static/bootstrap-reboot.min.css"></link>
		<link rel="stylesheet" href="static/navx-navigation.min.css"></link>
		<link rel="stylesheet" href="static/navx-styles.css"></link>
		<link rel="stylesheet" href="static/fontawesome-all.min.css"></link>
	</head>
	<body>
		<div id="mainViewNoLoader" style="z-index: 100; display: ">
			<script type="text/javascript">
				let selectedActivity = null;
				let selectedOt = null;
				let selectedEdge = null;
				let visualization = null;
				let celonisUrl = null;
				let celonisApi = null;
				let celonisMapper = null;
				let celonis1DWrapper = new Celonis1DWrapper(null);
				let celonisNDWrapper = new CelonisNDWrapper(null);
				let strAttributesForExtraction = null;
				let numAttributesForExtraction = null;
				let db = null;
				let evFeatures = null;
				let objFeatures = null;
				let evFeaturesTable = null;
				let objFeaturesTable = null;
				let sqlDefaultQuery = "SELECT * FROM OCEL_OBJECTS LIMIT 20";
				let evFeaturesNormalizedFiltered = null;
				let objFeaturesNormalizedFiltered = null;
				let evFeaturesCorrDct = null;
				let objFeaturesCorrDct = null;
				let featVarianceThreshold = 0.05;
				var csvOcelContent = null;
				var arr = null;
			</script>
			<div id="uploadPart" style="display: ">
				<!--<img src="static/pads_rwth.png" /><br />
				<h3>OC-DFG visualization</h3>
				Welcome! Please upload an object-centric event log in the OCEL-XML and/or the OCEL-JSON formats.
				-->
				<div class=" h-100 d-flex justify-content-center align-items-center">
					<div>
						<img src="static/ocpm.png"></img>
						<div style="height: 5%;">
						</div>
						<div style="text-align: center;">
							<div>OC-PM is a novel application for object-centric process mining.</div>
							<div>Logs in the JSON/XML-OCEL formats can be ingested,
							and advanced visualizations/statistics are provided.</div>
							<div>Please start by uploading an event log in the application.</div>
						</div>
						
						<div id="drop_zone" ondrop="handleFileSelect2(event)" ondragover="allowDrop(event)" style="height: 25%; width: 100%" class="d-flex justify-content-center align-items-center">
						  <p>Drag an object-centric event log to this drop zone ...</p>
						</div>

						<div id="initial_upload" style="height: 20%; width: 100%; display: " class="d-flex justify-content-center align-items-center">
							... Or upload it using the following button: &nbsp;&nbsp;&nbsp; <input type="file" id="upload" />
						</div>
						
						<div id="celonis_connection_parameters" style="width: 100%; display: " style="text-align: center;">
							<div>.. Or connect to Celonis and retrieve an analysis!</div>
							<div>Celonis URL: <input id="celonis_url" type="text"></input> Celonis API: <input id="celonis_api" type="text"></input> <button class="btn btn-primary" onclick="javascript:connectToCelonis()">Connect</button></div>
						</div>

						<div id="celonis_waiting_circle" style="display: none; text-align: center;">
							<div>Please select the analysis to download:</div>
							<div>
								<select name="dataModelSelectionUpload" id="dataModelSelectionUpload">
									
								</select>
								<button class="btn btn-primary" onclick="javascript:downloadDataModelFromCelonis()">Download</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id="csvUpload" style="display: none">
				<script>
		function CSVrenderTable(content=null, maxrow=15, targetTable="parsedCSV") {
			if (content != null) {
				csvOcelContent = content;
			}
			let sep = document.getElementById("CSVseparator").value;
			let quotechar = document.getElementById("CSVquotechar").value;
			arr = CsvImporter.parseCSV(csvOcelContent, sep, quotechar);
			let innerHTML = [];
			innerHTML.push("<table border='1' class='table'>");
			innerHTML.push("<thead><tr>");
			let j = 0;
			while (j < arr[0].length) {
				innerHTML.push("<th>"+arr[0][j]+"</th>");
				j++;
			}
			innerHTML.push("</tr>");
			innerHTML.push("</thead>");
			innerHTML.push("<tbody>");
			innerHTML.push("<tr>");
			j = 0;
			while (j < arr[0].length) {
				innerHTML.push("<td><select id='csvoption_"+j+"' class='csvoption'>");
				let actSelected = arr[0][j].toLowerCase().indexOf("act") > -1;
				let timestSelected = arr[0][j].toLowerCase().indexOf("time") > -1;
				let evIdSelected = arr[0][j].toLowerCase().indexOf("id") > -1;
				let objTypeSelected = arr[0][j].toLowerCase().indexOf("type") > -1;
				let selected = "";
				if (!(actSelected || timestSelected || evIdSelected || objTypeSelected)) {
					selected = " selected";
				}
				innerHTML.push("<option value='attribute'"+selected+">Event Attribute</option>");
				selected = "";
				if (actSelected) {
					selected = " selected";
				}
				innerHTML.push("<option value='activity'"+selected+">Activity</option>");
				selected = "";
				if (timestSelected && (!(actSelected || evIdSelected || objTypeSelected))) {
					selected = " selected";
				}
				innerHTML.push("<option value='timestamp'"+selected+">Timestamp</option>");
				selected = "";
				if (evIdSelected && (!(actSelected || timestSelected || objTypeSelected))) {
					selected = " selected";
				}
				innerHTML.push("<option value='evid'"+selected+">Event ID</option>");
				selected = "";
				if (objTypeSelected && (!(actSelected || evIdSelected || timestSelected))) {
					selected = " selected";
				}
				innerHTML.push("<option value='objtype'"+selected+">Object Type</option>");

				innerHTML.push("</select></td>");
				j++;
			}
			innerHTML.push("</tr>");
			let i = 1;
			while (i < Math.min(maxrow, arr.length)) {
				innerHTML.push("<tr>");
				j = 0;
				while (j < arr[i].length) {
					innerHTML.push("<td>"+arr[i][j]+"</td>");
					j++;
				}
				innerHTML.push("</tr>");
				i++;
			}
			innerHTML.push("</tbody></table>");
			document.getElementById(targetTable).innerHTML = innerHTML.join();
		}
		
		function CSVconvertToOCEL() {
			let sep = document.getElementById("CSVseparator").value;
			let quotechar = document.getElementById("CSVquotechar").value;
			let separators = [];
			let objectQuotes = document.getElementById("CSVobjectquotes").value;
			if (objectQuotes == "classic") {
				separators = ["'", "\""];
			}
			
			let evIdColumn = [];
			let activityColumn = [];
			let timestColumn = [];
			let attributes = [];
			let objTypes = [];
			for (let sel of document.getElementsByClassName("csvoption")) {
				att = arr[0][parseInt(sel.id.split("csvoption_")[1])];
				value = sel.value;
				if (value == "evid") {
					evIdColumn.push(att);
				}
				else if (value == "activity") {
					activityColumn.push(att);
				}
				else if (value == "timestamp") {
					timestColumn.push(att);
				}
				else if (value == "attribute") {
					attributes.push(att);
				}
				else if (value == "objtype") {
					objTypes.push(att);
				}
			}
			let errors = [];
			if (evIdColumn.length > 1) {
				errors.push("At most one column must be selected as event identifier!");
			}
			if (activityColumn.length != 1) {
				errors.push("Exactly one column must be selected as activity!");
			}
			if (timestColumn.length != 1) {
				errors.push("Exactly one column must be selected as timestamp!");
			}
			if (objTypes.length == 0) {
				errors.push("At least a column must be selected as object type!");
			}
			
			if (errors.length == 0) {
				// can proceed
				if (evIdColumn.length == 1) {
					evIdColumn = evIdColumn[0];
				}
				else {
					evIdColumn = null;
				}
				eventLog = CsvOcelImporter.apply(csvOcelContent, activityColumn[0], timestColumn[0], objTypes, attributes, evIdColumn, separators, sep, quotechar);
				document.getElementById("uploadPart").style.display = "none";
				document.getElementById("mainApplication").style.display = "";
				document.getElementById("csvUpload").style.display = "none";
				createVisualization();
			}
			else {
				let innerHTML = "";
				for (let err of errors) {
					innerHTML += "<p style='color: red'>"+err+"</p>";
				}
				document.getElementById("CSVimportingErrors").innerHTML = innerHTML;
			}
		}
	</script>
				<div id="CSVpreliminaryParameters" class="container-fluid">
					<p>Please select the correct values for the separator and the quote character of the CSV. Moreover, please provide a mapping for the columns
					(i.e., which column is the activity, timestamp, object type, event attribute, event identifier).</p>
					<span>Separator: <input type="text" id="CSVseparator" value=","></input></span>
					<span>Quote characters: <input type="text" id="CSVquotechar" value='"'></input></span>
					<span>Object Quotes:
						<select id="CSVobjectquotes">
							<option value="classic">Classic (' or ")</option>
							<option value="absent">Absent</option>
						</select>
					</span>
					<span><button onclick="javascript:CSVrenderTable()">Re-Build Table</button></span>
				</div>
				
				<div id="parsedCSV">
				
				</div>
				
				<div id="CSVimportingErrors">
					
				</div>
				
				<button onclick="javascript:CSVconvertToOCEL()">Obtain OCEL</button>
			</div>
			<div id="mainApplication" style="display: none" class="container-fluid">
				<div id="header" style="background-color:" class="border-bottom" style="height: 81px">
					<nav id="navigationHeader" class="navigation navigation-justified" style="background-image: url('static/top-background.png'); background-size:100% 100%;">
						<div class="navigation-header">

						</div>
						<div class="navigation-body">		
							<ul class="navigation-menu">
								<li class="navigation-item">
									<div class="spinningcircle" id="spinningcircle" style="display: none"></div>
								</li>
								<li class="navigation-item">
									<a href="ocel.html"><img src="static/ocpm_red.png"></img></a>&nbsp;&nbsp;&nbsp;&nbsp;
								</li>
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showProcessModelPage()"><i class="fas fa-project-diagram"></i>&nbsp;<span style="font-size: 8pt">&nbsp;Process&nbsp;Schema</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showEventsList()"><i class="fas fa-atom"></i><span style="font-size: 10pt">&nbsp;Events</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showObjectsList()"><i class="fas fa-database"></i>&nbsp;<span style="font-size: 10pt">&nbsp;Objects</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showMachineLearning()"><i class="fab fa-mixer"></i>&nbsp;<span style="font-size: 8pt">&nbsp;Machine&nbsp;Learning</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showAdvancedFiltering()"><i class="fas fa-camera"></i>&nbsp;<span style="font-size: 8pt">&nbsp;Advanced&nbsp;Filtering</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showGraphs()"><i class="fas fa-chart-pie"></i>&nbsp;<span style="font-size: 10pt">&nbsp;Statistics</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showConformance()"><i class="fas fa-bell"></i>&nbsp;<span style="font-size: 10pt">&nbsp;Conformance</span></a>
								</li>

								<li class="navigation-item">
									<a class="navigation-link" href="javascript:downloadSVG()"><i class="fas fa-download"></i>&nbsp;<span style="font-size: 10pt">&nbsp;SVG</span></a>
								</li>

								<li class="navigation-item">
									<a class="navigation-link" href="javascript:downloadJsonOcel()"><i class="fas fa-download"></i>&nbsp;<span style="font-size: 10pt">&nbsp;JSON</span></a>
								</li>

								<li class="navigation-item">
									<a class="navigation-link" href="javascript:downloadXmlOcel2()"><i class="fas fa-download"></i>&nbsp;<span style="font-size: 10pt">&nbsp;XML2</span></a>
								</li>
							</ul>
						</div>
					</nav>
				</div>
				<div id="processModelPage" style="display:; overflow: hidden">
					<div class="row" id="processModelStatsModelContainer" style="height: calc(100vh - 81px);">
						<!-- style="background-image: url('static/left-background.png'); background-size:100% 100%;"-->
						<div class="align-self-center text-center" style="width: 190px">
							<div class="panel panel-default">
								<div class="panel-heading"><h4>Statistics</h4></div>
								<div class="panel-body">
									<div>N. Events:</div>
									<div id="numEvents0">
									<span id="numEvents" style="font-family: geneva; font-weight: bold; font-size: 18pt">0</span>/<span id="numEventsOriginal" style="font-family: geneva; font-weight: bold; font-size: 18pt">0</span>
									</div>
									<div>N. Unique Objects:</div>
									<div id="numUniqueObjects0">
									<span id="numUniqObjects" style="font-family: geneva; font-weight: bold; font-size: 18pt">0</span>/<span id="numUniqObjectsOriginal" style="font-family: geneva; font-weight: bold; font-size: 18pt">0</span>
									</div>
									<div>N. Total Objects:</div>
									<div id="numTotalObjects0">
									<span id="numTotalObjects" style="font-family: geneva; font-weight: bold; font-size: 18pt">0</span>/<span id="numTotalObjectsOriginal" style="font-family: geneva; font-weight: bold; font-size: 18pt">0</span>
									</div>
								</div>
							</div>
							<div>&nbsp;</div>
							<div class="panel panel-default">
								<div class="panel-heading"><h4>Sliders</h4></div>
								<div class="panel-body">
									<div>% of Activities:</div>
									<div><input id="af_slider" type="range" min="0" max="100" value="70" class="slider form-range"></div>
									<div>% of Paths:</div>
									<div><input id="pf_slider" type="range" min="0" max="100" value="0" class="slider form-range"></div>
									<div>&nbsp;</div>
									<div><button id="apply_changes" onclick="doVisualization()" class="btn btn-primary">Apply Sliders</button></div>
								</div>
							</div>
						</div>
						<div class="border-left" style="width: calc(98vw - 190px);">
							<div id="graphContainerHeader">
								<nav id="navigationGraph" class="navigation navigation-justified border-bottom">
									<div class="navigation-header">

									</div>
									<div class="navigation-body">		
										<ul class="navigation-menu">
										
											<div class="navigation-row" style="font-size: 13pt">
												<div>Visualization:
												<select id="visualizationType" class="form-select">
													<option value="bpmn">OC-BPMN</option>
													<option value="bpmnPerformance">OC-BPMN (performance)</option>
													<option value="petriNet">OC-Petri Net</option>
													<option value="petriNetPerformance">OC-Petri Net (performance)</option>
													<option value="dfg" selected>OC-DFG</option>
												</select></div>
												<div>Annotation:
												<select id="annotationSelector" class="form-select">
													<option id="events" value="0">Events (E/EC)</option>
													<option id="unique_objects" value="1" selected>Unique Objects (UO)</option>
													<option id="total_objects" value="2">Total Objects (TO)</option>
												</select></div>
												<div>Orientation:
												<select id="orientationSelector" class="form-select">
													<option id="horizontal" value="horizontal" selected>Horizontal</option>
													<option id="vertical" value="vertical">Vertical</option>
												</select></div>
												<div><button id="apply_changes2" onclick="doVisualization()" class="btn btn-primary">Apply</button></div>
											</div>

											<div class="navigation-row" style="font-size: 13pt">
												<div>Filters:</div>
												<div id="filtersList" style="font-weight: bold">
													No filter is applied currently.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
												</div>
												<div><button id="reset_filters" onclick="resetFilters()" class="btn btn-primary">Reset All Filters</button></div>
											</div>
											
										</ul>
									</div>
								</nav>
							</div>
							<div id="graphContainer0" style="height: calc(100vh - 162px); width: 100%; background-color: white; overflow: scroll;">
								<div id="graphContainer"></div>
							</div>
						</div>
						<ul id="menu" style="display: none">
						</ul>
					</div>
					<script type="text/javascript">
						var navigationGraph = null;
						var conformanceNavigation = null;
						var mlNavigation = null;
						var allFilters = [];
											
						function doVisualization(initNavGraph=true) {
							let af = document.getElementById("af_slider").value / 100.0;
							let pf = document.getElementById("pf_slider").value / 100.0;
							let annotation = parseInt(document.getElementById("annotationSelector").value);
							visualization.ACTIVITY_FREQUENCY = af;
							visualization.PATHS_FREQUENCY = pf;
							visualization.IDX = annotation;
							visualization.displayType = document.getElementById("visualizationType").value;
							visualization.DEFAULT_DIRECTION = document.getElementById("orientationSelector").value;
							visualization.represent();
							if (navigationGraph == null && initNavGraph) {
								navigationGraph = new Navigation(document.getElementById("navigationGraph"));
								navigationGraph = 1;
							}
						}
						
						function resetFilters() {
							resetPageFilters();
							visualization.resetFilters();
							doVisualization(false);
						}
						
						function resetPageFilters() {
							allFilters = [];
							let filtersContainer = document.getElementById("filtersList");
							filtersContainer.innerHTML = "No filter is applied currently.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
						}
						
						function deleteFilter(index) {
							allFilters.splice(index, 1);
							setFilters();
							doVisualization(false);
						}

						function setFilters() {
							visualization.resetFilters();
							for (let filter of allFilters) {
								addFilter(filter[0], filter[1], false);
							}
							setFiltersOnPage();
						}
						
						function addFilter(filterDescription, filterMethod, addToPage=true) {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM addFilter"});
							
							setTimeout(function() {
								if (addToPage) {
									this.allFilters.push([filterDescription, filterMethod]);
								}
								setFiltersOnPage();
								eval(filterMethod);
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}
						
						function setFiltersOnPage() {
							let filtersContainer = document.getElementById("filtersList");
							if (allFilters.length == 0) {
								filtersContainer.innerHTML = "No filter is applied currently.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
							}
							else {
								filtersContainer.innerHTML = "";
								for (let filterId in allFilters) {
									let filterLi = document.createElement("div");
									filtersContainer.appendChild(filterLi);
									filterLi.innerHTML = allFilters[filterId][0];
									let cancelFilter = document.createElement("a");
									cancelFilter.href = "javascript:deleteFilter("+filterId+")";
									cancelFilter.innerHTML = "<i class=\"fas fa-trash\"></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
									filterLi.appendChild(cancelFilter);
								}
							}
						}
						
						function downloadJsonOcel() {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM downloadJsonOcel"});
							setTimeout(function() {
								let jsonStri = JsonOcelExporter.exportLog(visualization.model.ocel);
								download(jsonStri, "obj-centr-log.jsonocel", "text/json");
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}
						
						function downloadSVG() {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM downloadSVG"});
							setTimeout(function() {
								visualization.exportSvg(visualization.graph);
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}
						
						function downloadXmlOcel() {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM downloadXmlOcel"});
							setTimeout(function() {
								let xmlStri = XmlOcelExporter.exportLog(visualization.model.ocel);
								download(xmlStri, "obj-centr-log.xmlocel", "text/xml");
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}

						function downloadXmlOcel2() {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM downloadXmlOcel2"});
							setTimeout(function() {
								let xmlStri = Xml2OcelExporter.exportLog(visualization.model.ocel);
								download(xmlStri, "obj-centr-log.xml", "text/xml");
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}
						
						function downloadCsvOcel() {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM downloadCsvOcel"});
							setTimeout(function() {
								let csvStri = CsvOcelExporter.apply(visualization.model.ocel);
								download(csvStri, "obj-centr-log.csv", "text/csv");
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}
						
						function flattenEventLog() {
							let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM downloadCsvOcel"});
							setTimeout(function() {
								let ot = document.getElementById("flatteningOt").value;
								let eventLog = OcelFlattening.flatten(visualization.model.ocel, ot);
								let xmlStri = XesExporter.apply(eventLog);
								download(xmlStri, "flattened.xes", "text/xml");
								Pm4JS.stopAlgorithm(thisUuid, {});
							}, 100);
						}
						
						function expandActivity() {
							setTimeout(function() {
								visualization.doExpandActivity(selectedActivity);
								visualization.represent();
							}, 100);
						}
						
						function expandEdge() {
							setTimeout(function() {
								visualization.expandedEdges[selectedEdge] = 0;
								visualization.represent();
							}, 100);
						}
						
						function seeRelatedObjAct() {
							let relObj = visualization.model.getRelObjActivity(selectedActivity, selectedOt);
							let stru = relObj.toString();
							if (stru.length > 1000) {
								stru = stru.substring(0, 999) + "...";
							}
							Swal.fire({title: "Related Objects", confirmButton: "ok", html: stru});
						}
						
						function filterRelatedObjectsActivity() {
							return addFilter("<i class=\"fas fa-plus-circle\"></i>Related objects ("+selectedActivity+";"+selectedOt+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterRelatedObjectsActivitySpecific(\""+selectedActivity+"\", \""+selectedOt+"\")");
						}
						
						function filterNonRelatedObjectsActivity() {
							return addFilter("<i class=\"fas fa-minus-circle\"></i>&nbsp;Non related objects ("+selectedActivity+";"+selectedOt+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterNonRelatedObjectsActivitySpecific(\""+selectedActivity+"\", \""+selectedOt+"\")");
						}
						
						function filterNonStartingWith() {
							return addFilter("<i class=\"fas fa-chevron-right\"></i>&nbsp;Non starting with ("+selectedActivity+";"+selectedOt+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterNonStartingWithSpecific(\""+selectedActivity+"\", \""+selectedOt+"\")");
						}
						
						function filterNonEndingWith() {
							return addFilter("<i class=\"fas fa-chevron-left\"></i>&nbsp;Non ending with ("+selectedActivity+";"+selectedOt+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterNonEndingWithSpecific(\""+selectedActivity+"\", \""+selectedOt+"\")");
						}
						
						function filterRelatedObjectsEdge() {
							return addFilter("<i class=\"fas fa-user-plus\"></i>&nbsp;Related objects to edge ("+selectedEdge[0]+"->"+selectedEdge[1]+"@"+selectedEdge[2]+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterRelatedObjectsEdgeSpecific(\""+selectedEdge[0]+"\", \""+selectedEdge[1]+"\", \""+selectedEdge[2]+"\")");
						}
						
						function filterNonRelatedObjectsEdge() {
							return addFilter("<i class=\"fas fa-user-minus\"></i>&nbsp;Non related objects to edge ("+selectedEdge[0]+"->"+selectedEdge[1]+"@"+selectedEdge[2]+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterNonRelatedObjectsEdgeSpecific(\""+selectedEdge[0]+"\", \""+selectedEdge[1]+"\", \""+selectedEdge[2]+"\")");
						}
						
						function filterObjectTypes() {
							let selectedOptions = [];
							for (let option of document.getElementById("objectTypes").children) {
								if (option.selected) {
									selectedOptions.push(option.value);
								}
							}
							return addFilter("<i class=\"fab fa-superpowers\"></i>&nbsp;Object types filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "filterObjectsTypesSpecific(\""+selectedOptions.toString()+"\")");
						}
						
						function filterRelatedObjectsActivitySpecific(selectedActivity, selectedOt) {
							if (selectedOt == "null") {
								selectedOt = null;
							}
							let relObj = visualization.model.getRelObjActivity(selectedActivity, selectedOt);
							let filteredModel = visualization.model.filterRelatedObjects(relObj);
							visualization.setFilteredModel(filteredModel);
						}
						
						function filterNonRelatedObjectsActivitySpecific(selectedActivity, selectedOt) {
							if (selectedOt == "null") {
								selectedOt = null;
							}
							let relObj = visualization.model.getRelObjActivity(selectedActivity, selectedOt);
							let allObjOt = Object.keys(visualization.model.otObjectsView[selectedOt].objectsIds);
							let difference = allObjOt.filter(x => !relObj.includes(x));
							let filteredModel = visualization.model.filterNonRelatedObjects(difference, relObj);
							visualization.setFilteredModel(filteredModel); 
						}
						
						function filterNonStartingWithSpecific(selectedActivity, selectedOt) {
							if (selectedOt == "null") {
								selectedOt = null;
							}
							let startingWith = visualization.model.otObjectsView[selectedOt].getStartingWith(selectedActivity);
							let allObjOt = Object.keys(visualization.model.otObjectsView[selectedOt].objectsIds);
							let difference = allObjOt.filter(x => !startingWith.includes(x));
							let filteredModel = visualization.model.filterNonRelatedObjects(difference, startingWith);
							visualization.setFilteredModel(filteredModel);
						}
						
						function filterNonEndingWithSpecific(selectedActivity, selectedOt) {
							if (selectedOt == "null") {
								selectedOt = null;
							}
							let endingWith = visualization.model.otObjectsView[selectedOt].getEndingWith(selectedActivity);
							let allObjOt = Object.keys(visualization.model.otObjectsView[selectedOt].objectsIds);
							let difference = allObjOt.filter(x => !endingWith.includes(x));
							let filteredModel = visualization.model.filterNonRelatedObjects(difference, endingWith);
							visualization.setFilteredModel(filteredModel);
						}
						
						function filterRelatedObjectsEdgeSpecific(sourceActivity, targetActivity, objectType) {
							if (selectedOt == "null") {
								selectedOt = null;
							}
							let relObj = visualization.model.getRelObjEdge([sourceActivity, targetActivity], objectType);
							let filteredModel = visualization.model.filterRelatedObjects(relObj);
							visualization.setFilteredModel(filteredModel);
						}
						
						function filterNonRelatedObjectsEdgeSpecific(sourceActivity, targetActivity, objectType) {
							if (selectedOt == "null") {
								selectedOt = null;
							}
							let relObj = visualization.model.getRelObjEdge([selectedEdge[0], selectedEdge[1]], selectedEdge[2]);
							let allObjOt = Object.keys(visualization.model.otObjectsView[selectedEdge[2]].objectsIds);
							let difference = allObjOt.filter(x => !relObj.includes(x));
							let filteredModel = visualization.model.filterNonRelatedObjects(difference, relObj);
							visualization.setFilteredModel(filteredModel);
						}
						
						function filterObjectsTypesSpecific(selectedOptions) {
							selectedOptions = selectedOptions.split(",");
							let filteredModel = visualization.model.filterObjectTypes(selectedOptions);
							visualization.setFilteredModel(filteredModel);
						}
						
						function seeRelatedObjEdge() {
							let relObj = visualization.model.getRelObjEdge([selectedEdge[0], selectedEdge[1]], selectedEdge[2]);
							let stru = relObj.toString();
							if (stru.length > 1000) {
								stru = stru.substring(0, 999) + "...";
							}
							Swal.fire({title: "Related Objects", confirmButton: "ok", html: stru});
						}
						
						function callbackActivity(activity, ot) {
							selectedActivity = activity;
							selectedOt = ot;
						}
						
						function callbackEdge(edge) {
							selectedEdge = edge;
						}
						
						function callbackStatistics(events, uo, to, originalEvents, originalUo, originalTo) {
							document.getElementById("numEvents").innerHTML = events;
							document.getElementById("numUniqObjects").innerHTML = uo;
							document.getElementById("numTotalObjects").innerHTML = to;
							document.getElementById("numEventsOriginal").innerHTML = originalEvents;
							document.getElementById("numUniqObjectsOriginal").innerHTML = originalUo;
							document.getElementById("numTotalObjectsOriginal").innerHTML = originalTo;
						}
						
						function allowDrop(ev) {
						  ev.preventDefault();
						}
						
						function handleFileSelect2(evt) {
							console.log(evt);
							evt.preventDefault();
							var files = evt.dataTransfer.files;
							f = files[0];
							var reader = new FileReader();
							reader.onload = function(e) {
								loadFileCommon(e, f);
							}
							reader.readAsBinaryString(f);
							//reader.readAsText(f);
						}
						
						function handleFileSelect(evt) {
							var files = evt.target.files; // FileList object
							// use the 1st file from the list
							f = files[0];
							var reader = new FileReader();
							reader.onload = function(e) {
								loadFileCommon(e, f);
							}
							reader.readAsBinaryString(f);
							//reader.readAsText(f);
						}
						
						function loadFileCommon(e, f) {
							let contentStri = e.target.result;
							return loadContentStri(f.name, contentStri);
						}
						
						function loadContentStri(fileName, contentStri) {
							if (fileName.endsWith(".zip")) {
								JSZip.loadAsync(contentStri).then(function (zip) {
									for (f in zip.files) {
										zip.file(f).async("string").then(function(unzipped) {
											loadContentStri(f, unzipped);
										});
										break;
									}
								});
							}
							else if (fileName.endsWith(".xml") || fileName.endsWith(".xml2")) {
								eventLog = Xml2OcelImporter.importLog(contentStri);
								createVisualization();
							}
							else if (fileName.endsWith(".xmlocel")) {
								eventLog = XmlOcelImporter.importLog(contentStri);
								createVisualization();
							}
							else if (fileName.endsWith(".jsonocel")) {
								eventLog = JsonOcelImporter.importLog(contentStri);
								createVisualization();
							}
							else {
								document.getElementById("uploadPart").style.display = "none";
								document.getElementById("mainApplication").style.display = "none";
								document.getElementById("csvUpload").style.display = "";
								CSVrenderTable(contentStri);
							}
						}
						
						function createVisualization() {
							document.getElementById("mainApplication").style.display = "";
							document.getElementById("csvUpload").style.display = "none";
							document.getElementById("uploadPart").style.display = "none";
							visualization = new OcdfgVisualization(new OcdfgModel(eventLog), "graphContainer");
							visualization.callbackActivity = callbackActivity;
							visualization.callbackEdge = callbackEdge;
							visualization.callbackStatistics = callbackStatistics;
							visualization.populateStatistics();
							doVisualization();
						}
						
						document.getElementById('upload').addEventListener('change', handleFileSelect, false);
					</script>
				</div>
				<script type="text/javascript">
					var numEvents = 0;
					var currStart0 = 0;
					var currEnd0 = 0;
					var currStart = 0;
					var currEnd = 0;
					var pageSize = 500;
				</script>
				<div id="eventsListPage" style="display: none; font-size: 15pt;">
					<p>The page shows the list of events of the log. Each event is distinguished by its fundamental properties (ID, activity and timestamp),
					a list of related objects for each type, and values for some attributes. Clicking an object, it is possible to see the lifecycle
					of the object.</p>
					<div>
						<b>Number of events:</b> <span id="numEventsEventsPage"></span>
						&nbsp;&nbsp;<b>Current displayed range:</b> <span id="currStartEventsPage"></span>-<span id="currEndEventsPage"></span>
						&nbsp;&nbsp;<button class="button" onclick="javascript:decreaseRange()">&#8592;</button><button class="button" onclick="javascript:increaseRange()">&#8594;</button>
					</div>
					<table id="eventsListTable" border="1"  class="table">
					</table>
				</div>
				<div id="objectsListPage" style="display: none; font-size: 15pt;">
					<nav id="objectsPageNavigation" class="navigation navigation-justified border-bottom">
						<div class="navigation-header">

						</div>
						<div class="navigation-body">
							<ul class="navigation-menu">
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showObjectsList1()"><i class="fas fa-database"></i>&nbsp;<span style="font-size: 13pt">Objects List</span></a>
								</li>

								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showObjectsObjRelations1()"><i class="fas fa-database"></i>&nbsp;<span style="font-size: 13pt">Relations Visualization (1)</span></a>
								</li>

								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showObjectsObjRelations2()"><i class="fas fa-database"></i>&nbsp;<span style="font-size: 13pt">Relations Visualization (2)</span></a>
								</li>
							</ul>
						</div>
					</nav>
					
					<div id="objectsListPage1" style="display: none">
						<p>The page shows the properties of the objects, after the selection of an object type. Each object is distinguished by the timestamp of the first
						event of its lifecycle, the timestamp of the last event of its lifecycle, and the difference between them.</p>
						<p>To start, please select an object type:
						<select id="otObjListSelection" class="form-select">
						</select>
						<button id="showObjListOt" onclick="showObjListOt()" class="btn btn-primary">Show the list of Objects</button>
						</p>
						<div style="height: 80%; overflow-y: scroll">
							<table id="objectsListTable" border="1" class="table">
							</table>
						</div>
					</div>
					
					<div id="objectsObjRelations1" style="display: none">
						<div id="objectsObjRelations1Vis">
						</div>
					</div>
					
					<div id="objectsObjRelations2" style="display: none">
						<div id="objectsObjRelations2Vis">
						</div>
					</div>
				</div>
				<div id="executionsPage" style="display: none; font-size: 15pt;">
					<p>An execution describes the connection between the lifecycle of different objects. Executions can be grouped together if they are equivalent in
					the involved object types.</p>
					<table id="executionsTable" border="1" class="table">
					</table>
				</div>
				<div id="networkAnalysisPage" style="display: none; font-size: 15pt;">
					<table id="networkAnalysisContainer" style="width: 100%; height: 85%">
						<tr>
							<td style="width: 15%; font-size: 9pt">
								<p>
									Link Method<br />
									<select id="NAlinkMethod" name="NAlinkMethod">
										<option value="graph" selected>Graph-based</option>
										<option value="outIn">OUT-IN attribute</option>
									</select>
								</p>
								<p>
									Graph Link<br />
									<select id="NAgraphLink" name="NAgraphLink">
										<option value="descendants" selected>Descendants Graph</option>
										<option value="interaction">Interaction Graph</option>
										<option value="cobirth">Cobirth Graph</option>
										<option value="codeath">Codeath Graph</option>
										<option value="inheritance">Inheritance Graph</option>
									</select>
								</p>
								<p>
									OUT-attribute<br />
									<select id="NAoutAttribute" name="NAoutAttribute">
										<option value="ocel:activity" selected>ocel:activity</option>
									</select>
								</p>
								<p>
									IN-attribute<br />
									<select id="NAinAttribute" name="NAinAttribute">
										<option value="ocel:activity" selected>ocel:activity</option>
									</select>
								</p>
								<p>
									<input type="checkbox" id="NAkeepFirst" name="NAkeepFirst" checked></input>
									<label for="NAkeepFirst">Keep First Link</label>
								</p>
								<p>
									<input type="checkbox" id="NAexpandLinks" name="NAexpandLinks"></input>
									<label for="NAexpandLinks">Expand Links</label>
								</p>
								<p>
									SN aggregation<br />
									<select id="NAsnAttribute" name="NAsnAttribute">
										<option value="ocel:activity" selected>ocel:activity</option>
									</select>
								</p>
								<p>
									TN aggregation<br />
									<select id="NAtnAttribute" name="NAtnAttribute">
										<option value="ocel:activity" selected>ocel:activity</option>
									</select>
								</p>
								<p>
									E agg. place<br />
									<select id="NAedgeAggPlace" name="NAedgeAggPlace">
										<option value="source" selected>Source Node</option>
										<option value="target">Target Node</option>
									</select>
								</p>
								<p>
									E agg. attr.<br />
									<select id="NAedgeAggAttribute" name="NAedgeAggAttribute">
										<option value="ocel:activity" selected>ocel:activity</option>
									</select>
								</p>
								<p>
									Annotation<br />
									<select id="NAannotation" name="NAannotation">
										<option value="frequency" selected>Frequency</option>
										<option value="performance">Performance</option>
									</select>
								</p>
								<button class="btn btn-primary" id="NAapply" name="NAapply" onclick="javascript:applyNetworkAnalysisConfiguration()">Apply Configuration</button>
							</td>
							<td style="width: 85%;">
								<div id="naGraphvizContainer">
								</div>
							</td>
						</tr>
					</table>
				</div>
				<div id="advancedFilteringPage" style="display: none; font-size: 15pt;">
					<div>
						<h4><a href="javascript:filterMinOccurrencesActivity()">Filter Activities having a Minimum Number of Occurrences</a></h4>
					</div>
					<div>
						<h4><a href="javascript:filterEssentialEvents()">Filter Essential Events</a></h4>
					</div>
					<div>
						<h4><a href="javascript:filterEssentialEventsOrMinOccurrencesActivity()">Filter Essential Events OR Activities having a Minimum Number of Occurrences</a></h4>
					</div>
					<div>
						<h4><a href="javascript:filterOtMinNumRelatedObjects()">Filter Object Types having a Minimum Number of Objects</a></h4>
					</div>
					<div>
						<h4><a href="javascript:filterOtMinNumRelatedEvents()">Filter Object Types having a Minimum Number of Related Events</a></h4>
					</div>
					<div>
						<h4><a href="javascript:filterRateUniqueActivities()">Filter Object Types having a Minimum Rate of Unique Activities</a></h4>
					</div>
					<div>
						<h4><a href="javascript:sampleEventLogFiltering()">Random Sampling Event Log (connected components)</a></h4>
					</div>
					<div>
						<h4><a href="javascript:randomSampleEvents()">Random Sampling Event Log (random events)</a></h4>
					</div>
					<div>
						<h4><a href="javascript:randomSampleObjects()">Random Sampling Event Log (random objects)</a></h4>
					</div>
					<div>
						<h4><a href="javascript:randomSampleObjectTypes()">Random Sampling Event Log (random object types)</a></h4>
					</div>
					<div>
						<h4><a href="javascript:anomalousObjectsFiltering()">Anomalous Objects Filtering (Isolation Forest)</a></h4>
					</div>
					<div>
						<h4><a href="javascript:stageBasedFiltering()">Stage-Based Filtering</a></h4>
					</div>
					<div>
						<h4><a href="javascript:filterParentsChildren()">Parent-Children Filtering</a></h4>
					</div>
					<div>
						<h4><a href="javascript:addParentToChildren()">Add Parent Attribute to Children Objects</a></h4>
					</div>
					<div>
						<h4><a href="javascript:showActOtFilterContainer()">Activity - OT Filter (manual)</a></h4>
					</div>
					<div id="actOtFilterContainer0" style="display: none">
						<div id="actOtFilterContainer">
						</div>
						<button id="actOtFilter" onclick="javascript:actOtApplyFilterFromTable0()">Apply Filter</button>
					</div>
					<!--<div>
						<h4><a href="javascript:actOtAutomaticFiltering()">Activity - OT Filter (automatic)</a></h4>
					</div>-->
				</div>
				<div id="machineLearningPage" style="display: none; font-size: 15pt;">
					<nav id="machineLearningNavigation" class="navigation navigation-justified border-bottom">
						<div class="navigation-header">

						</div>
						<div class="navigation-body">
							<ul class="navigation-menu">
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showSQLexplorer()"><i class="fas fa-database"></i>&nbsp;<span style="font-size: 13pt">SQL explorer</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showIsolationForest()"><i class="fas fa-house-user"></i>&nbsp;<span style="font-size: 13pt">Isolation Forest</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showPCAvisualization()"><i class="fas fa-signal"></i>&nbsp;<span style="font-size: 13pt">Dimensionality Reduction</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showDTvisualization()"><i class="fas fa-tree"></i>&nbsp;<span style="font-size: 13pt">Decision Trees</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showMLStatsvisualization()"><i class="fas fa-plus-square"></i>&nbsp;<span style="font-size: 13pt">Correlation Statistics</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showConformanceRules()"><i class="fas fa-house-user"></i>&nbsp;<span style="font-size: 13pt">Conformance Rules</span></a>
								</li>
							</ul>
						</div>
					</nav>
					<div id="machineLearningSQL" style="display: none">
						<p>This page permits to explore, using the SQL language, the table of the features (events=<b>OCEL_EVENTS</b>, objects=<b>OCEL_OBJECTS</b>) on the provided log.
						Patterns such as excessive repetition of an activity during the lifecycle of an object can therefore be considered here.</p>
						<textarea id="sqlQueryInput" name="sqlQueryInput" rows="4" cols="50"></textarea>
						<button class="btn btn-primary" onclick="javascript:executeSQLQuery()">Execute Query</button>
						<div id="machineLearningSQLResult">
						</div>
					</div>
					<div id="machineLearningIsolationForest" style="display: none;">
						<p>The isolation forest calculated on the objects' features permits to identify the objects with peculiar behavior (different from the one of the other objects).
						Objects which are more anomalous are reported first.</p>
						<table id="machineLearningIsolationForestResult" border="1" class="table" style="font-size: 15pt">
						</table>
					</div>
					<div id="machineLearningPCA" style="display: none">
						<p>The first two components of the discovered features are illustrated in this page. This permits to visually identify the groups of objects with
						similar behavior (in terms of the calculated features).</p>
						<p>
							Select the dimensionality reduction technique: 
							<select id="dimensionalityReductionTechnique" name="dimensionalityReductionTechnique" onchange="applyPca()">
								<option value="FASTMAP">FASTMAP</option>
								<option value="PCA">PCA</option>
							</select>
						</p>
						<div id="plotlyPCA" style="width: 100%; height: 80%;">
							
						</div>
					</div>
					<div id="machineLearningDT" style="display: none">
						<p>A decision tree helps to understand the conditions which determine a given outcome of a case:</p>
						<table id="machineLearningDTContainer" style="width: 100%; height: 85%">
							<tr>
								<td style="width: 15%;">
									<p>Select the categorical attribute:</p>
									<p><select id="DTcategoryAttr" name="categoryAttr"></select></p>
									<p>Select the attributes to ignore:</p>
									<p><select id="DTignoredAttributes" name="ignoredAttributes" multiple></select></p>
									<p><button onclick="javascript:buildDT()">Build</button></p>
								</td>
								<td style="width: 15%;">
									<div id="machineLearningDTResult">
									</div>
								</td>
							</tr>
						</table>
					</div>
					<div id="machineLearningStats" style="display: none">
						<p>Shows the correlation between a selected feature and all the others features. This permits to understand which other factors influence the given feature.</p>
						<p>
							Select the target variable: <select id="mlstatstargetvariable" onchange="javascript:applyMLStats()"></select>
						</p>
						<p>Select the type of statistic that should be considered:
							<select id="mlstattypestatistic" onchange="javascript:applyMLStats()">
								<option value="correlationCoefficient" selected>Correlation Coefficient</option>
								<option value="covariance">Covariance</option>
								<option value="goodmanKruskalsGamma">Goodman-Kruskals Gamma</option>
								<option value="kendallsTau">Kendall's Tau</option>
								<option value="spearmansRho">Spearman's Rho</option>
							</select>
						</p>
						<div id="plotlyMLStatGraph" style="width: 100%; height: 75%;">
						</div>
					</div>
					<div id="conformanceRules" style="display: none; font-size: 15pt;">
						<p>Some <b>conformance rules</b> (the value of a feature should be contained in a range) are inferred automatically from the extracted features.
						Anomalous objects are identified by such rules.</p>
						<select id="conformanceRulesOtSelection" name="conformanceRulesOtSelection"></select>
						<button onclick="javascript:showRulesPerObjectType()">Show Conformance Rules</button>
						<table id="conformanceRulesContainer" class="table" style="font-size: 15pt">
							<thead>
								<tr>
									<th>Feature</th>
									<th>Minimum Normal Value</th>
									<th>Maximum Normal Value</th>
									<th>Score</th>
									<th>Number of Deviations</th>
									<th>Filter Deviations</th>
								</tr>
							</thead>
							<tbody id="conformanceRulesTbody">
							</tbody>
						</table>
					</div>
				</div>
				<div id="plotlyGraphsPage" style="display: none;">
					<div class="row" style="height: 85%">
						<!--align-self-center text-center-->
						<div class="col-2 border-right">
							<h6><span style="font-size: 16pt">Select the statistic:</span></h6>
							<div><i class="fas fa-chart-pie"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyOtGraph')"><span style="font-size: 16pt">Objects per Type</span></a></div>
							<div><i class="fas fa-chart-bar"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyActGraph')"><span style="font-size: 16pt">Events per Activity</span></a></div>
							<div><i class="fas fa-chart-bar"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyObjPerEveGraph')"><span style="font-size: 16pt">N. Objects per Event</span></a></div>
							<div><i class="fas fa-chart-bar"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyLifecycleLengthGraph')"><span style="font-size: 16pt">Length of Object Lifecycle</span></a></div>
							<div><i class="fas fa-chart-bar"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyEventsPerTimeGraph')"><span style="font-size: 16pt">Events per Time</span></a></div>
							<div><i class="fas fa-box"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyLifecycleDurationGraph')"><span style="font-size: 16pt">Lifecycle Duration (logarithmic)</span></a></div>
							<div><i class="fas fa-chart-area"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyDottedChartColorActivity')"><span style="font-size: 16pt">Dotted Chart (color: activity)</span></a></div>
							<div><i class="fas fa-chart-area"></i>&nbsp;<a href="javascript:showSpecificGraph('plotlyDottedChartColorObjType')"><span style="font-size: 16pt">Dotted Chart (color: object type)</span></a></div>
						</div>
						<div class="col-10">
							<div id="plotlyOtGraph" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyActGraph" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyObjPerEveGraph" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyLifecycleLengthGraph" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyLifecycleDurationGraph" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyEventsPerTimeGraph" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyDottedChartColorActivity" style="width: 100%; height: 100%; display: none">
								
							</div>
							<div id="plotlyDottedChartColorObjType" style="width: 100%; height: 100%; display: none">
								
							</div>
						</div>
					</div>
				</div>
				<div id="conformancePage" style="display: none; font-size: 15pt;">
					<nav id="conformanceNavigation" class="navigation navigation-justified border-bottom">
						<div class="navigation-header">

						</div>
						<div class="navigation-body">
							<ul class="navigation-menu">
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showConformancePageNumObjects()"><i class="fas fa-sort-numeric-up-alt"></i>&nbsp;<span style="font-size: 15pt">Number of Objects</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showConformancePageLifecycleObjects()"><i class="fas fa-life-ring"></i>&nbsp;<span style="font-size: 15pt">Objects Lifecycle</span></a>
								</li>
								
								<li class="navigation-item">
									<a class="navigation-link" href="javascript:showConformancePageDurationsObjects()"><i class="fas fa-clock"></i>&nbsp;<span  style="font-size: 15pt">Objects Duration</span></a>
								</li>							
							</ul>
						</div>
					</nav>
					<div id="conformanceCheckingNumObjects" style="display:">
						<p>The page shows the objects of the given type which are related to events of the given activity in extraordinary number
						(lower than avg - stdev, or higher than avg + stdev). It is offered a possibility to filter on the events related to such objects, to understand
						the control flow in these situations.</p>
						<table id="conformanceCheckingNumObjectsTable" class="table" style="font-size: 15pt">
							
						</table>
					</div>
					<div id="conformanceCheckingLifecycleObjects" style="display: none">
						<p>The page shows the log skeleton constraints (default noise: 5%) that are violated by the objects of the given type. Each rule is reported
						with a description, the overall number of violations, and a possibility to filter the events related to such objects.</p>
						<table id="conformanceCheckingLifecycleObjectsTable" class="table" style="font-size: 15pt">
							
						</table>
					</div>
					<div id="conformanceCheckingDurationObjects" style="display: none">
						<p>The page identifies deviations in the duration of the lifecycle of the objects. Objects having an exceptional durations are here identified,
						along with the number of deviations and a possibility to filter the events related to such objects.</p>
						<table id="conformanceCheckingDurationObjectsTable" class="table" style="font-size: 15pt">
							
						</table>
					</div>
				</div>
				<div class="hover_bkgr_fricc">
					<span class="helper"></span>
					<div>
						<div class="popupCloseButton">&times;</div>
						<h4><b>Lifecycle of the Object:</b> <span id="popupObjId"></h4>
						<div style="width: 100%; height: 85%; overflow: scroll">
							<table id="customEventsListTable" border="1" class="table">
							</table>
						</div>
					</div>
				</div>
			</div>
			<script src="logs/example-jsonocel.js"></script>
			<script type="text/javascript">
				function fillAttributesLinkNetworkAnalysis() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM fillAttributesLinkNetworkAnalysis"});
					setTimeout(function() {
						let attributesList = StreamAttrWrapper.attributesList(Object.values(visualization.model.ocel["ocel:events"]));
						console.log(attributesList);
						let option = null;
						for (let att of attributesList) {
							if (att != "ocel:activity") {
								option = document.createElement("option");
								option.value = att;
								option.text = att;
								document.getElementById("NAoutAttribute").appendChild(option);
								option = document.createElement("option");
								option.value = att;
								option.text = att;
								document.getElementById("NAinAttribute").appendChild(option);
								option = document.createElement("option");
								option.value = att;
								option.text = att;
								document.getElementById("NAsnAttribute").appendChild(option);
								option = document.createElement("option");
								option.value = att;
								option.text = att;
								document.getElementById("NAtnAttribute").appendChild(option);
								option = document.createElement("option");
								option.value = att;
								option.text = att;
								document.getElementById("NAedgeAggAttribute").appendChild(option);
							}
						}
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}
				
				function applyNetworkAnalysisConfiguration() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM fillAttributesLinkNetworkAnalysis"});
					setTimeout(function() {
						let linkMethod = document.getElementById("NAlinkMethod").value;
						let graphLink = document.getElementById("NAgraphLink").value;
						let outAttribute = document.getElementById("NAoutAttribute").value;
						let inAttribute = document.getElementById("NAinAttribute").value;
						let keepFirst = document.getElementById("NAkeepFirst").checked;
						let expandLinks = document.getElementById("NAexpandLinks").checked;
						let snAggregation = document.getElementById("NAsnAttribute").value;
						let tnAggregation = document.getElementById("NAtnAttribute").value;
						let aggPlace = document.getElementById("NAedgeAggPlace").value;
						let aggAttr = document.getElementById("NAedgeAggAttribute").value;
						let annotation = document.getElementById("NAannotation").value;
						
						let links = null;
						if (linkMethod == "graph") {
							let graph = null;
							if (graphLink == "descendants") {
								graph = OcelGraphs.objectDescendantsGraph(visualization.model.ocel);
							}
							else if (graphLink == "interaction") {
								graph = OcelGraphs.objectInteractionGraph(visualization.model.ocel);
							}
							else if (graphLink == "cobirth") {
								graph = OcelGraphs.objectCobirthGraph(visualization.model.ocel);
							}
							else if (graphLink == "codeath") {
								graph = OcelGraphs.objectCodeathGraph(visualization.model.ocel);
							}
							else if (graphLink == "inheritance") {
								graph = OcelGraphs.objectInheritanceGraph(visualization.model.ocel);
							}
							links = OcelLinkAnalysis.linkEventsWithObjGraph(visualization.model.ocel, graph);
						}
						else {
							links = OcelLinkAnalysis.linkAnalysisAttributeOutIn(visualization.model.ocel, outAttribute, inAttribute);
							links = OcelLinkAnalysis.filterLinksByTimestamp(visualization.model.ocel, links);
						}
						if (keepFirst) {
							links = OcelLinkAnalysis.filterFirstLink(visualization.model.ocel, links);
						}
						if (expandLinks) {
							links = OcelLinkAnalysis.expandLinks(visualization.model.ocel, links);
						}
						links = OcelLinkAnalysis.linksToFinalForm(visualization.model.ocel, links);
						let aggPlace1 = false;
						if (aggPlace == "source") {
							aggPlace1 = true;
						}
						let performance = false;
						if (annotation == "performance") {
							performance = true;
						}
						let naResult = NetworkAnalysis.apply(links, snAggregation, tnAggregation, aggAttr, aggPlace1);
						let naVis = NetworkAnalysisGraphvizVisualizer.apply(naResult, performance);
						let svgXml = Viz(naVis, { format: "svg"});
						document.getElementById("naGraphvizContainer").innerHTML = svgXml;
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}
				
				function filterDeviationsLifecycleObjects(objType, dev) {
					let objectIdentifiers = visualization.model.conformanceLifecycleObjects.getRelatedObjects(objType, dev).toString();
					showProcessModelPage();
					addFilter("<i class=\"fab fa-mixer\"></i>&nbsp;Deviations on the Lifecycle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "executionGraphFilterDescrSpecific(\""+objectIdentifiers+"\")");
				}
				
				function filterDeviationsDurationObjects(objType) {
					let objectIdentifiers = Object.keys(visualization.model.conformanceDurationObjects.deviations[objType]).toString();
					showProcessModelPage();
					addFilter("<i class=\"fab fa-mixer\"></i>&nbsp;Deviations on the Lifecycle Duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "executionGraphFilterDescrSpecific(\""+objectIdentifiers+"\")");
				}
				
				function filterDeviationsNumObjects(activity, objType) {
					let objectIdentifiers = Object.keys(visualization.model.conformanceNumObjs.deviatingObjects[activity][objType]).toString();
					showProcessModelPage();
					addFilter("<i class=\"fab fa-mixer\"></i>&nbsp;Deviations on the number of Objects&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "executionGraphFilterDescrSpecific(\""+objectIdentifiers+"\")");
				}
				
				function executionGraphFilterDescr(descr) {
					let objectIdentifiers = visualization.model.executionGraph.getObjectIdentifiers(descr).toString();
					showProcessModelPage();
					addFilter("<i class=\"fab fa-mixer\"></i>&nbsp;Executions Filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "executionGraphFilterDescrSpecific(\""+objectIdentifiers+"\")");
				}
				
				function filterExactSetObjects(objectIdentifiers) {
					showProcessModelPage();
					addFilter("<i class=\"fab fa-mixer\"></i>&nbsp;Executions Filter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;", "executionGraphFilterDescrSpecific(\""+objectIdentifiers+"\")");
				}
				
				function executionGraphFilterDescrSpecific(relObj) {
					relObj = relObj.split(",");
					let filteredModel = visualization.model.filterRelatedObjects(relObj);
					visualization.setFilteredModel(filteredModel);
				}
				
				function hideAllDivsPages() {
					document.getElementById("processModelPage").style.display = "none";
					document.getElementById("eventsListPage").style.display = "none";
					document.getElementById("objectsListPage").style.display = "none";
					document.getElementById("executionsPage").style.display = "none";
					document.getElementById("plotlyGraphsPage").style.display = "none";
					document.getElementById("conformancePage").style.display = "none";
					document.getElementById("networkAnalysisPage").style.display = "none";
					document.getElementById("machineLearningPage").style.display = "none";
					//advancedFilteringPage
					document.getElementById("advancedFilteringPage").style.display = "none";
				}
				
				function showProcessModelPage() {
					hideAllDivsPages();
					document.getElementById("processModelPage").style.display = "";
				}
				
				function showEventsList() {
					hideAllDivsPages();
					numEvents = Object.keys(visualization.model.ocel["ocel:events"]).length;
					currStart0 = 0;
					currEnd0 = pageSize - 1;
					document.getElementById("eventsListPage").style.display = "";
					populateNumEventsEventsPage();
				}
				
				function populateNumEventsEventsPage() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM showEventsList"});
					setTimeout(function() {
						currStart = Math.max(0, Math.min(numEvents, currStart0));
						currEnd = Math.max(0, Math.min(numEvents, currEnd0));
						document.getElementById("numEventsEventsPage").innerHTML = numEvents;
						document.getElementById("currStartEventsPage").innerHTML = currStart;
						document.getElementById("currEndEventsPage").innerHTML = currEnd;
						eventsListFactory = new EventsListFactory(visualization.model);
						eventsListFactory.buildEventsTable(document.getElementById("eventsListTable"), null, true, null, currStart, currEnd);
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}
				
				function increaseRange() {
					currStart0 = currStart0 + pageSize;
					currEnd0 = currEnd0 + pageSize;
					populateNumEventsEventsPage();
				}
				
				function decreaseRange() {
					currStart0 = currStart0 - pageSize;
					currEnd0 = currEnd0 - pageSize;
					populateNumEventsEventsPage();
				}
				
				function hideAllObjectsSubpages() {
					document.getElementById("objectsListPage1").style.display = "none";
					document.getElementById("objectsObjRelations1").style.display = "none";
					document.getElementById("objectsObjRelations2").style.display = "none";
				}
				
				function showObjectsList1() {
					hideAllObjectsSubpages();
					document.getElementById("objectsListPage1").style.display = "";
				}
				
				function showObjectsObjRelations1() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM showObjectsObjRelations1"});
					
					setTimeout(function() {
						let objectsInteractionGraph = OcelGraphs.objectInteractionGraph(visualization.model.ocel);
						let objectsDescendantsGraph = OcelGraphs.objectDescendantsGraph(visualization.model.ocel);
						let objectsCobirthGraph = OcelGraphs.objectCobirthGraph(visualization.model.ocel);
						let objectsCodeathGraph = OcelGraphs.objectCodeathGraph(visualization.model.ocel);
						let objectInheritanceGraph = OcelGraphs.objectInheritanceGraph(visualization.model.ocel);
						
						let gviz = OcelObjRelationsVisualizer.apply(visualization.model.ocel, objectsInteractionGraph, objectsDescendantsGraph, objectsCobirthGraph, objectsCodeathGraph, objectInheritanceGraph);
						console.log(gviz);

						let svgXml = Viz(gviz, { format: "svg"});

						document.getElementById("objectsObjRelations1Vis").innerHTML = svgXml;
						
						hideAllObjectsSubpages();
						document.getElementById("objectsObjRelations1").style.display = "";
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}
				
				function showObjectsObjRelations2() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM showObjectsObjRelations2"});

					setTimeout(function() {
						let objectsDescendantsGraph = OcelGraphs.objectDescendantsGraph(visualization.model.ocel);
						let objectInheritanceGraph = OcelGraphs.objectInheritanceGraph(visualization.model.ocel);
						let objectsParents = OcelGraphs.graphFindParents(visualization.model.ocel);
						let objectsLocks = OcelGraphs.graphFindLocks(visualization.model.ocel);
						let objectsInterrupts = OcelGraphs.graphFindInterrupts(visualization.model.ocel);
						
						let gviz = OcelObjRelations2Visualizer.apply(visualization.model.ocel, objectsDescendantsGraph, objectInheritanceGraph, objectsParents, objectsLocks, objectsInterrupts);
						console.log(gviz);
						
						let svgXml = Viz(gviz, { format: "svg"});
						
						document.getElementById("objectsObjRelations2Vis").innerHTML = svgXml;
						
						hideAllObjectsSubpages();
						document.getElementById("objectsObjRelations2").style.display = "";
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}
				
				function showObjectsList() {
					//visualization.model.calculateExecutions();
					hideAllDivsPages();
					showObjectsList1();
					document.getElementById("objectsListPage").style.display = "";
				}
				
				function showExecutions() {
					visualization.model.calculateExecutions();
					hideAllDivsPages();
					document.getElementById("executionsPage").style.display = "";
					visualization.model.executionGraph.buildExecutionsTable(document.getElementById("executionsTable"));
				}
				
				function showNetworkAnalysis() {
					fillAttributesLinkNetworkAnalysis();
					applyNetworkAnalysisConfiguration();
					hideAllDivsPages();
					document.getElementById("networkAnalysisPage").style.display = "";
				}
				
				function executeSQLQuery() {
					let sqlQuery = document.getElementById("sqlQueryInput").value;
					executeSQLQueryInternal(sqlQuery);
				}
				
				function showMachineLearning() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM ML"});
					setTimeout(function() {
						hideAllDivsPages();
						calculateEventFeatures();
						calculateObjectFeatures();
						prepareSQLDatabase();
						insertObjectFeaturesInSQLDatabase();
						//insertEventFeaturesInSQLDatabase();
						showSQLexplorer();
						document.getElementById("machineLearningPage").style.display = "";
						if (mlNavigation == null) {
							mlNavigation = new Navigation(document.getElementById("mlNavigation"));
						}
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}
				
				function showAdvancedFiltering() {
					hideAllDivsPages();
					fillTableAdvancedFiltering();
					document.getElementById("advancedFilteringPage").style.display = "";
				}
				
				function hideAllMLpages() {
					document.getElementById("machineLearningSQL").style.display = "none";
					document.getElementById("machineLearningIsolationForest").style.display = "none";
					document.getElementById("machineLearningPCA").style.display = "none";
					document.getElementById("machineLearningDT").style.display = "none";
					document.getElementById("machineLearningStats").style.display = "none";
					document.getElementById("conformanceRules").style.display = "none";
				}
				
				function showSQLexplorer() {
					hideAllMLpages();
					document.getElementById("sqlQueryInput").value = sqlDefaultQuery;
					executeSQLQuery();
					document.getElementById("machineLearningSQL").style.display = "";
				}
				
				function showIsolationForest() {
					hideAllMLpages();
					document.getElementById("machineLearningIsolationForest").style.display = "";
					calculateIsolationForest(visualization.model.ocel);
				}
				
				function showConformanceRules() {
					hideAllMLpages();
					document.getElementById("conformanceRulesOtSelection").innerHTML = "";
					document.getElementById("conformanceRulesTbody").innerHTML = "";
					document.getElementById("conformanceRules").style.display = "";
					let objectTypes = Object.keys(GeneralOcelStatistics.objectsPerTypeCount(visualization.model.ocel));
					for (let ot of objectTypes) {
						let sel = document.createElement("option");
						sel.text = ot;
						sel.value = ot;
						document.getElementById("conformanceRulesOtSelection").appendChild(sel);
					}
				}
				
				function showPCAvisualization() {
					hideAllMLpages();
					document.getElementById("machineLearningPCA").style.display = "";
					applyPca();
				}
				
				function showDTvisualization() {
					hideAllMLpages();
					document.getElementById("machineLearningDT").style.display = "";
					applyDT();
				}
				
				function showMLStatsvisualization() {
					hideAllMLpages();
					document.getElementById("machineLearningStats").style.display = "";
					prepareMLStats();
					applyMLStats();
				}
				
				function showGraphs() {
					hideAllDivsPages();
					document.getElementById("plotlyGraphsPage").style.display = "";
					plotlyOcelGraphs = new PlotlyOcelGraphs(visualization.model);
					showSpecificGraph("plotlyOtGraph");
				}
				
				function showConformance() {
					hideAllDivsPages();
					showConformancePageNumObjects();
					document.getElementById("conformancePage").style.display = "";
					if (conformanceNavigation == null) {
						conformanceNavigation = new Navigation(document.getElementById("conformanceNavigation"));
					}
				}
				
				function hideAllConformancePages() {
					document.getElementById("conformanceCheckingNumObjects").style.display = "none";
					document.getElementById("conformanceCheckingLifecycleObjects").style.display = "none";
					document.getElementById("conformanceCheckingDurationObjects").style.display = "none";
				}
				
				function showConformancePageNumObjects() {
					visualization.model.calculateConformanceNumObjs();
					hideAllConformancePages();
					document.getElementById("conformanceCheckingNumObjects").style.display = "";
				}
				
				function showConformancePageLifecycleObjects() {
					visualization.model.calculateConformanceLifecycleObjects();
					hideAllConformancePages();
					document.getElementById("conformanceCheckingLifecycleObjects").style.display = "";
				}
				
				function showConformancePageDurationsObjects() {
					visualization.model.calculateConformanceDurationObjects();
					hideAllConformancePages();
					document.getElementById("conformanceCheckingDurationObjects").style.display = "";
				}
				
				function showSpecificGraph(divName) {
					document.getElementById("plotlyOtGraph").style.display = "none";
					document.getElementById("plotlyActGraph").style.display = "none";
					document.getElementById("plotlyObjPerEveGraph").style.display = "none";
					document.getElementById("plotlyLifecycleLengthGraph").style.display = "none";
					document.getElementById("plotlyLifecycleDurationGraph").style.display = "none";
					document.getElementById("plotlyEventsPerTimeGraph").style.display = "none";
					document.getElementById("plotlyDottedChartColorActivity").style.display = "none";
					document.getElementById("plotlyDottedChartColorObjType").style.display = "none";				
					
					document.getElementById(divName).style.display = "";
					if (divName == "plotlyOtGraph") {
						plotlyOcelGraphs.buildOtGraph();
					}
					else if (divName == "plotlyActGraph") {
						plotlyOcelGraphs.buildActivitiesGraph();
					}
					else if (divName == "plotlyObjPerEveGraph") {
						plotlyOcelGraphs.buildObjectsPerEventGraph();
					}
					else if (divName == "plotlyLifecycleLengthGraph") {
						plotlyOcelGraphs.buildLifecycleLength();
					}
					else if (divName == "plotlyLifecycleDurationGraph") {
						plotlyOcelGraphs.buildObjectDuration();
					}
					else if (divName == "plotlyEventsPerTimeGraph") {
						plotlyOcelGraphs.buildEventsPerTime();
					}
					else if (divName == "plotlyDottedChartColorActivity") {
						plotlyOcelGraphs.buildDottedChartActivities();
					}
					else if (divName == "plotlyDottedChartColorObjType") {
						plotlyOcelGraphs.buildDottedChartOtype();
					}
				}
				
				function clickedObjectInEveTable(obj) {
					let relTuples = visualization.model.overallObjectsView.objectsIdsSorted[obj];
					let relEvs = {};
					for (let tup of relTuples) {
						relEvs[tup[0]] = 0;
					}
					let eventsListFactory = new EventsListFactory(visualization.model);
					eventsListFactory.buildEventsTable(document.getElementById("customEventsListTable"), events=relEvs, enable_click=false, target_obj=obj);
					$('.hover_bkgr_fricc').show();
					document.getElementById("popupObjId").innerHTML = obj;
				}
				
				function showGraphvizExecutionObject(obj) {
					let gv = visualization.model.executions[5][obj];
					let svgXml = Viz(gv, { format: "svg"});
					document.getElementById("customEventsListTable").innerHTML = svgXml;
					$('.hover_bkgr_fricc').show();
					document.getElementById("popupObjId").innerHTML = obj+" (execution)";
				}
				
				function showObjListOt() {
					let thisUuid = Pm4JS.startAlgorithm({"name": "OCPM showObjListOt"});
					setTimeout(function() {
						let selectedOt = document.getElementById("otObjListSelection").value;
						objectsListFactory = new ObjectsListFactory(visualization.model);
						objectsListFactory.buildObjectsTable(document.getElementById("objectsListTable"), selectedOt);
						Pm4JS.stopAlgorithm(thisUuid, {});
					}, 100);
				}

				$('.hover_bkgr_fricc').click(function(){
					$('.hover_bkgr_fricc').hide();
				});
				$('.popupCloseButton').click(function(){
					$('.hover_bkgr_fricc').hide();
				});
			</script>
			<script type="text/javascript">
	const menu = document.querySelector('#menu');
	// hide the menu
	//window.addEventListener('click', event => menu.style.display = 'none')
	// show the menu when right-clicked
	window.addEventListener('contextmenu', event => {
	  event.preventDefault()
	  menu.style.setProperty('--mouse-x', event.clientX + 'px')
	  menu.style.setProperty('--mouse-y', event.clientY + 'px')
	  menu.style.display = 'block'
	});

				var navigationHeader = new Navigation(document.getElementById("navigationHeader"));
			</script>
			<script type="text/javascript">
				function ScrollZoom(container,max_scale,factor){
					var target = container;
					var size = {w:target.width(),h:target.height()}
					var pos = {x:0,y:0}
					var zoom_target = {x:0,y:0}
					var zoom_point = {x:0,y:0}
					var scale = 1
					target.css('transform-origin','0 0')
					target.on("mousewheel DOMMouseScroll",scrolled)

					function scrolled(e){
						var offset = container.offset()
						zoom_point.x = e.pageX - offset.left
						zoom_point.y = e.pageY - offset.top

						e.preventDefault();
						var delta = e.delta || e.originalEvent.wheelDelta;
						if (delta === undefined) {
						  //we are on firefox
						  delta = e.originalEvent.detail;
						}
						delta = Math.max(-1,Math.min(1,delta)) // cap the delta to [-1,1] for cross browser consistency

						// determine the point on where the slide is zoomed in
						zoom_target.x = (zoom_point.x - pos.x)/scale
						zoom_target.y = (zoom_point.y - pos.y)/scale

						// apply zoom
						scale += delta*factor * scale
						scale = Math.max(1,Math.min(max_scale,scale))

						// calculate x and y based on zoom
						pos.x = -zoom_target.x * scale + zoom_point.x
						pos.y = -zoom_target.y * scale + zoom_point.y


						// Make sure the slide stays in its container area when zooming out
						if(pos.x>0)
							pos.x = 0
						if(pos.x+size.w*scale<size.w)
							pos.x = -size.w*(scale-1)
						if(pos.y>0)
							pos.y = 0
						 if(pos.y+size.h*scale<size.h)
							pos.y = -size.h*(scale-1)

						update()
					}

					function update(){
						target.css('transform','translate('+(pos.x)+'px,'+(pos.y)+'px) scale('+scale+','+scale+')')
					}
				}
				
				new ScrollZoom($('#graphContainer'), 4, 0.5);
				
				class OCPMObserver {
					algorithmStarted(uuid, details) {
						document.getElementById("spinningcircle").style.display = '';
					}
					
					algorithmStatusUpdated(uuid, oldDetails, details) {
					}
					
					algorithmStopped(uuid, details) {
						document.getElementById("spinningcircle").style.display = 'none';
					}
				}
				
				Pm4JS.registerObserver(new OCPMObserver());
				const queryString = window.location.search;
				const urlParams = new URLSearchParams(queryString);
				
				if (urlParams.get("ocel") != null) {
					let fileName = urlParams.get("ocel");
					if (fileName.endsWith(".zip")) {
						JSZipUtils.getBinaryContent(fileName, function(err, data) {
							if(err) {
								throw err; // or handle err
							}
							loadContentStri(fileName, data);
						});
					}
					else {
						$.get(fileName).then(function(data) {
							loadContentStri(fileName, data);
						});
					}
				}
			</script>
			
			<script type="text/javascript">
				for (let evId in eventLog["ocel:events"]) {
					eventLog["ocel:events"][evId]["ocel:timestamp"] = new Date(eventLog["ocel:events"][evId]["ocel:timestamp"]);
				}
				Ocel20FormatFixer.apply(eventLog);
				createVisualization();
			</script>
		</div>
		<div id="htmlLoadView" style="z-index: 200; display: none">
			<div class="row h-100 justify-content-center align-items-center">
				<h1>Uploading to Target System ...</h1>
			</div>
		</div>
	</body>
</html>